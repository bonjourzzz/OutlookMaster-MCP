# Outlook MCP 服务器

一个基于模型上下文协议（MCP）的服务器，提供对Microsoft Outlook邮件功能的访问，允许大语言模型和其他MCP客户端通过标准化接口读取、搜索和管理邮件。

## 🚀 功能特性

本MCP服务器提供 **54个强大功能**，完全支持中文操作：

### 📁 基础邮件操作 (6个功能)
- **文件夹管理**: 列出Outlook客户端中的所有可用邮件文件夹
- **邮件列表**: 获取指定时间段内的邮件
- **邮件详情**: 查看完整的邮件内容，包括附件信息
- **撰写邮件**: 创建并发送新邮件（支持抄送、密送）
- **回复邮件**: 回复现有邮件（支持回复全部）
- **邮件缓存**: 智能缓存机制提高操作效率

### 🔍 智能搜索功能 (6个功能)
- **关键词搜索**: 通过联系人姓名、关键词或短语搜索邮件，支持OR操作符
- **日期范围搜索**: 按指定日期范围搜索邮件
- **未读邮件搜索**: 快速定位未读邮件
- **附件邮件搜索**: 查找包含附件的邮件
- **重要性搜索**: 按邮件重要性级别（高/中/低）搜索
- **组合搜索**: 支持多条件组合搜索

### ⚙️ 邮件管理功能 (4个功能)
- **标记状态**: 标记邮件为已读或未读
- **删除邮件**: 删除指定邮件
- **移动邮件**: 移动邮件到指定文件夹
- **标记重要**: 标记邮件为重要或跟进状态

### 📋 邮箱规则功能 (4个功能)
- **列出规则**: 查看所有现有的邮箱规则
- **创建规则**: 创建新的邮箱规则（简化版和高级版）
- **删除规则**: 删除指定的邮箱规则
- **启用/禁用规则**: 切换邮箱规则的启用状态

### 📦 批量操作功能 (3个功能)
- **批量标记**: 批量标记多封邮件为已读或未读
- **批量删除**: 批量删除多封邮件
- **邮件导出**: 导出邮件到文件

### 📎 附件管理功能 (3个功能)
- **下载附件**: 下载邮件附件到本地
- **附件信息**: 查看邮件附件详细信息
- **附件列表**: 列出所有带附件的邮件

### 📊 统计分析功能 (6个功能)
- **邮件统计**: 获取邮件文件夹统计信息
- **发件人统计**: 分析发件人邮件数量排行
- **邮件趋势**: 分析邮件接收趋势和模式
- **回复时间**: 统计邮件回复时间
- **文件夹摘要**: 获取所有文件夹摘要信息
- **高级发件人统计**: 详细的发件人数据分析

### 📅 日历集成功能 (4个功能)
- **日历事件**: 列出未来的日历事件
- **创建事件**: 创建新的日历事件
- **会议邀请**: 获取会议邀请信息
- **回复会议**: 回复会议邀请（接受/拒绝/暂定）

### 👥 联系人管理功能 (5个功能)
- **联系人列表**: 列出Outlook联系人
- **搜索联系人**: 按姓名、邮箱或公司搜索联系人
- **添加联系人**: 添加新联系人
- **联系人详情**: 获取联系人详细信息
- **联系人统计**: 基于联系人的邮件统计

### 🏷️ 邮件分类功能 (3个功能)
- **添加分类**: 为邮件添加分类标签
- **分类列表**: 列出所有邮件分类
- **按分类搜索**: 按分类标签搜索邮件

### 📋 任务管理功能 (3个功能)
- **任务列表**: 列出Outlook任务（全部/未完成/已完成）
- **从邮件创建任务**: 将邮件转换为任务
- **标记任务完成**: 标记任务为完成状态

### 🔄 邮件模板功能 (3个功能)
- **保存模板**: 将邮件保存为模板
- **模板列表**: 列出所有邮件模板
- **使用模板**: 使用模板撰写邮件

### 🤖 AI辅助功能 (4个功能)
- **邮件摘要**: 智能总结邮件内容
- **回复建议**: 基于邮件内容生成回复建议
- **情感检测**: 分析邮件情感倾向和紧急程度
- **自动分类**: 智能分类邮件并应用标签

## 💻 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.10或更高版本
- **Microsoft Outlook**: 已安装并配置，且有活跃账户
- **MCP客户端**: Claude Desktop或其他兼容MCP的客户端

## 🛠️ 安装步骤

1. **克隆或下载此仓库**
```bash
git clone https://github.com/bonjourzzz/outlook-mcp-server.git
cd outlook-mcp-server
```

2. **安装所需依赖**
```bash
pip install mcp>=1.2.0 pywin32>=305
```

3. **配置Claude Desktop**

将以下内容添加到您的Claude Desktop配置文件中：

```json
{
  "mcpServers": {
    "outlook": {
      "command": "python",
      "args": ["C:\\path\\to\\your\\outlook_mcp_server.py"],
      "env": {}
    }
  }
}
```

## 🎯 使用方法

### 启动服务器

```bash
python outlook_mcp_server.py
```

### 基础操作示例

```
列出我的所有邮件文件夹
显示我最近7天的邮件
查看第1封邮件的详细内容
撰写邮件给example@email.com，主题"测试"，内容"这是测试邮件"
```

### 搜索功能示例

```
搜索关于"会议 OR 项目"的邮件
搜索最近3天的未读邮件
搜索有附件的邮件
按日期范围搜索：2024-01-01到2024-01-31
```

### AI辅助示例

```
总结第1封邮件的内容
为第2封邮件建议回复
检测第3封邮件的情感倾向
自动分类第4封邮件
```

## 🔧 高级功能

### 邮箱规则管理
- 创建自动化邮件处理规则
- 支持按发件人、主题等条件分类
- 自动移动、标记或转发邮件

### 批量操作
- 支持批量处理多封邮件
- 邮件导出和备份功能
- 高效的缓存机制

### 统计分析
- 邮件趋势分析
- 发件人统计排行
- 回复时间分析

## 🛡️ 安全注意事项

- 此服务器可以访问您的Outlook邮件账户
- 能够读取、发送和管理邮件
- 请仅在受信任的MCP客户端和安全环境中使用
- 建议定期备份重要邮件

## ⚠️ 功能限制

### 技术限制
- **平台依赖**: 仅支持Windows操作系统
- **Outlook依赖**: 需要本地安装Microsoft Outlook
- **COM组件**: 依赖Windows COM接口
- **邮件历史**: 搜索范围限制为最近30天

### 功能限制
- **邮件格式**: 主要支持纯文本邮件内容
- **附件处理**: 支持下载和查看，但不支持在线编辑
- **规则复杂度**: 复杂邮箱规则建议在Outlook中手动创建
- **并发限制**: 不支持多用户同时访问

### AI功能说明
- **智能分析**: 基于关键词和规则的简单分析，非深度学习AI
- **情感检测**: 基于中文词典的基础情感分析
- **回复建议**: 基于模板和关键词的建议生成

## 🐛 故障排除

### 常见问题
1. **连接问题**: 确保Outlook正在运行且配置正确
2. **权限错误**: 以管理员身份运行或检查Outlook安全设置
3. **搜索问题**: 对于复杂搜索，尝试使用OR操作符
4. **规则创建失败**: 使用简化规则功能或在Outlook中手动创建

### 性能优化
- 限制搜索时间范围以提高性能
- 定期清理邮件缓存
- 避免频繁的大量邮件操作

## 📚 详细文档

更多使用说明请参考：
- [中文使用指南](中文使用指南.md) - 详细的功能说明和故障排除
- [配置示例](claude_desktop_config_中文.json) - Claude Desktop配置参考

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目采用MIT许可证 - 详见LICENSE文件

---

**注意**: 这是一个功能丰富的邮件管理工具，请根据您的实际需求选择合适的功能使用。
