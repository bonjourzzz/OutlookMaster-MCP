# Outlook MCP 服务器 - 中文使用指南

## 📋 功能概览

本MCP服务器提供54个强大的Outlook邮件管理功能，完全中文化界面，支持：

- 📁 基础邮件操作 (6个功能)
- 🔍 智能搜索功能 (5个功能)  
- ⚙️ 邮件管理功能 (4个功能)
- ⚙️ 邮箱规则功能 (6个功能) - 包含故障排除
- 📦 批量操作功能 (3个功能)
- 📎 附件管理功能 (3个功能)
- 📊 统计分析功能 (3个功能)
- 📅 日历集成功能 (4个功能)
- 👥 联系人管理功能 (4个功能)
- 🏷️ 邮件分类功能 (3个功能)
- 📋 任务管理功能 (3个功能)
- 🔄 邮件模板功能 (3个功能)
- 📊 高级分析功能 (3个功能)
- 🤖 AI辅助功能 (4个功能)

## 🚀 快速开始

### 基础操作示例
```
列出我的所有邮件文件夹
显示我最近7天的邮件
查看第1封邮件的详细内容
撰写邮件给example@email.com，主题"测试"，内容"这是测试邮件"
```

### 搜索功能示例
```
搜索关于"会议"的邮件
搜索最近3天的未读邮件
搜索有附件的邮件
按日期范围搜索：2024-01-01到2024-01-31
```

### 邮件管理示例
```
标记第1封邮件为已读
删除第2封邮件
移动第3封邮件到"工作"文件夹
```

### 邮箱规则示例（推荐使用简化版本）
```
检查文件夹是否存在：系统通知
创建简单规则"自动归档"，条件类型"发件人"，条件值"noreply@example.com"，操作类型"移动"，操作值"系统通知"
```

### 批量操作示例
```
批量标记邮件"1,2,3"为已读
批量删除邮件"4,5,6"
导出最近7天的邮件到文件
```

### AI辅助示例
```
总结第1封邮件的内容
为第2封邮件建议回复
检测第3封邮件的情感倾向
自动分类第4封邮件
```

## 🛠️ 故障排除

### 常见问题及解决方案

#### 问题1: 文件夹不存在错误
**错误**: "找不到目标文件夹 'XXX'"

**解决方案**:
1. 先检查文件夹是否存在：`检查文件夹是否存在：文件夹名`
2. 系统会自动创建不存在的文件夹
3. 使用现有文件夹名称（收件箱、已发送邮件、草稿等）

#### 问题2: 邮箱规则创建失败
**错误**: "MarkAsRead属性错误" 或 "规则验证失败"

**解决方案**:
1. 使用简化的规则创建功能：`create_simple_rule`
2. 一次只设置一个条件和一个操作
3. 对于复杂规则，建议在Outlook中手动创建

**推荐做法**:
```
# 不推荐：复杂规则
创建邮箱规则"复杂规则"，发件人包含"test"，主题包含"重要"，移动到"工作"，标记为已读

# 推荐：简单规则
创建简单规则"邮件归档"，条件类型"发件人"，条件值"noreply@example.com"，操作类型"移动"，操作值"系统通知"
```

#### 问题3: COM对象访问错误
**错误**: "COM异常" 或 "对象不支持此属性"

**解决方案**:
1. 确保Outlook正在运行
2. 重启Outlook和MCP服务器
3. 检查Outlook版本兼容性

#### 问题4: 权限不足
**错误**: "访问被拒绝"

**解决方案**:
1. 以管理员身份运行
2. 检查Outlook安全设置
3. 允许程序化访问

### 最佳实践

1. **文件夹管理**
   - 使用现有文件夹名称
   - 让系统自动创建新文件夹
   - 避免使用特殊字符

2. **规则创建**
   - 优先使用简单规则功能
   - 一次设置一个条件
   - 测试规则后再启用

3. **批量操作**
   - 先测试单个操作
   - 分批处理大量邮件
   - 定期备份重要邮件

4. **性能优化**
   - 限制搜索时间范围
   - 使用缓存功能
   - 避免频繁的大量操作

## 🎯 高级功能

### 统计分析
```
获取文件夹摘要信息
分析最近30天的邮件趋势
获取发件人统计排行榜
```

### 日历集成
```
列出未来7天的日历事件
创建会议"项目讨论"，开始时间"2024-01-15 14:00"，结束时间"2024-01-15 15:00"
获取最近的会议邀请
```

### 联系人管理
```
列出前50个联系人
搜索联系人"张三"
添加联系人"李四"，邮箱"lisi@example.com"，公司"ABC公司"
```

### 任务管理
```
列出所有未完成任务
从第1封邮件创建任务，截止日期"2024-01-20"
标记任务"处理邮件"为完成
```

## 💡 使用技巧

1. **邮件编号系统**: 每次列出邮件后，系统会为邮件分配临时编号，方便后续操作
2. **缓存机制**: 系统会缓存最近的邮件列表，提高操作效率
3. **中文命令**: 所有功能都支持自然的中文描述
4. **批量处理**: 支持用逗号分隔的邮件编号进行批量操作
5. **智能搜索**: 支持OR操作符和多种搜索条件组合

## 📞 技术支持

如果遇到问题：
1. 查看错误消息中的具体提示
2. 尝试使用简化版本的功能
3. 重启Outlook和MCP服务器
4. 检查系统要求和权限设置

## 🎯 功能限制说明

- 邮箱规则功能受Outlook版本限制
- 某些高级功能需要特定权限
- 大量数据操作可能需要时间
- AI功能基于简单规则，非真实AI

通过遵循这些指南和最佳实践，您可以充分利用Outlook MCP服务器的强大功能！
