# OutlookMaster-MCP

> 基于模型上下文协议（MCP）的Microsoft Outlook邮件管理服务器  
> 作者：ESM-NRHZ-Alan @ Amazon

## 概述

OutlookMaster-MCP是一个功能全面的MCP服务器，为大语言模型和MCP客户端提供对Microsoft Outlook邮件系统的标准化访问接口。该服务器集成了54项核心功能，支持邮件管理、智能搜索、统计分析等多个业务场景，完全支持中文操作环境。

## 系统架构

### 技术栈
- **协议标准**: Model Context Protocol (MCP) 1.2.0+
- **运行环境**: Python 3.10+ / Windows 10/11
- **核心依赖**: Microsoft Outlook (COM接口)
- **客户端支持**: Claude Desktop, Amazon Q CLI, 其他MCP兼容客户端

### 功能模块

#### 核心邮件操作 (6项)
- 文件夹管理与邮件列表
- 邮件详情查看与内容解析
- 邮件撰写、发送与回复
- 智能缓存机制

#### 高级搜索引擎 (6项)
- 多维度关键词搜索（支持OR逻辑）
- 时间范围与状态筛选
- 附件与重要性分类
- 复合条件查询

#### 邮件管理系统 (4项)
- 状态标记与分类管理
- 邮件移动与删除操作
- 重要性与跟进标记

#### 自动化规则引擎 (4项)
- 邮箱规则创建与管理
- 规则启用状态控制
- 条件触发与动作执行

#### 批量处理工具 (3项)
- 批量状态更新
- 批量删除与导出
- 高效批处理算法

#### 附件管理中心 (3项)
- 附件下载与信息查看
- 附件邮件检索
- 附件统计分析

#### 数据分析平台 (6项)
- 邮件统计与趋势分析
- 发件人行为分析
- 回复时间统计
- 文件夹使用情况

#### 日历集成服务 (4项)
- 日历事件管理
- 会议邀请处理
- 事件创建与响应

#### 联系人管理 (5项)
- 联系人CRUD操作
- 智能搜索与统计
- 联系人关联分析

#### 分类标签系统 (3项)
- 邮件分类管理
- 标签应用与搜索
- 分类统计报告

#### 任务管理集成 (3项)
- Outlook任务同步
- 邮件转任务功能
- 任务状态管理

#### 模板管理系统 (3项)
- 邮件模板存储
- 模板应用与管理
- 模板库维护

#### AI辅助功能 (4项)
- 邮件内容智能摘要
- 回复建议生成
- 情感倾向分析
- 自动分类建议

## 部署指南

### 环境准备

#### 系统要求
```
操作系统: Windows 10/11 (x64)
Python版本: 3.10.0 或更高版本
Outlook版本: Microsoft Outlook 2016+ (已配置邮箱账户)
```

#### 项目下载与依赖安装

**步骤1：下载项目到本地**

*方式1：使用Git命令（推荐）*

1. **打开命令行工具**：
   - Windows：按 `Win + R`，输入 `cmd`，按回车
   - 或者：按 `Win + X`，选择"Windows PowerShell"

2. **选择下载位置**：
   ```bash
   # 进入桌面（推荐新手使用）
   cd Desktop
   
   # 或者进入其他目录，如文档文件夹
   cd Documents
   ```

3. **下载项目**：
   ```bash
   git clone https://github.com/bonjourzzz/OutlookMaster-MCP.git
   cd OutlookMaster-MCP
   ```

4. **文件位置说明**：
   - 如果在桌面执行命令，文件会下载到：`C:\Users\你的用户名\Desktop\OutlookMaster-MCP\`
   - 如果在文档文件夹执行，文件会下载到：`C:\Users\你的用户名\Documents\OutlookMaster-MCP\`

*方式2：直接下载ZIP文件（适合不熟悉命令行的用户）*

1. 访问项目页面：https://github.com/bonjourzzz/OutlookMaster-MCP
2. 点击绿色的 "Code" 按钮
3. 选择 "Download ZIP"
4. 下载完成后，解压到任意目录，建议解压到桌面：`C:\Users\你的用户名\Desktop\OutlookMaster-MCP-main\`

**步骤2：安装Python依赖**

在项目文件夹中打开命令行，执行：
```bash
# 安装Python依赖
pip install mcp>=1.2.0 pywin32>=305
```

### 配置方案

#### 方案一：Amazon Q CLI集成（推荐）

**步骤1：插件安装**
1. 下载并安装Amazon Q插件
2. 启动插件，在对话界面右上角找到工具配置图标
3. 点击配置图标，选择"+"按钮进入MCP服务器配置界面

**步骤2：服务器配置**
```
配置项设置:
├── Scope: This workspace (推荐) / Global
├── Name: outlookmaster_mcp
├── Transport: stdio
├── Command: python
├── Arguments: [完整路径]\outlook_mcp_server.py
├── Environment variables: (留空)
└── Timeout: 60
```

**步骤3：配置验证**
- 重启VS Code或重新加载窗口
- 在Amazon Q聊天界面输入："列出我的邮件文件夹"
- 验证Outlook文件夹列表正常返回

#### 方案二：Claude Desktop集成

**配置文件修改**
```json
{
  "mcpServers": {
    "outlookmaster": {
      "command": "python",
      "args": ["C:\\path\\to\\outlook_mcp_server.py"],
      "env": {}
    }
  }
}
```

## 使用指南

### 服务启动
```bash
python outlook_mcp_server.py
```

### 基础操作示例

#### 邮件管理
```
# 文件夹操作
列出我的所有邮件文件夹
显示收件箱最近7天的邮件

# 邮件查看
查看第1封邮件的详细内容
显示邮件的附件信息

# 邮件操作
撰写邮件给example@email.com，主题"项目进展"，内容"请查收附件"
回复第2封邮件："已收到，谢谢"
```

#### 智能搜索
```
# 关键词搜索
搜索关于"会议 OR 项目"的邮件
搜索发件人为"张三"的所有邮件

# 条件筛选
搜索最近3天的未读邮件
搜索包含附件的重要邮件
按日期范围搜索：2024-01-01到2024-01-31
```

#### AI辅助分析
```
# 内容分析
总结第1封邮件的主要内容
分析第3封邮件的情感倾向和紧急程度

# 智能建议
为第2封邮件生成回复建议
自动分类第4封邮件并应用标签
```

## 技术规范

### 性能指标
- **邮件检索**: 支持最近30天邮件历史
- **批量操作**: 单次最多处理100封邮件
- **缓存机制**: 智能缓存提升响应速度
- **并发限制**: 单用户单会话模式

### 安全机制
- **权限控制**: 基于Windows用户权限
- **数据保护**: 本地处理，无数据上传
- **访问审计**: 操作日志记录
- **安全建议**: 仅在可信环境使用

### 限制说明

#### 技术限制
- 仅支持Windows操作系统
- 依赖本地Outlook客户端
- 基于COM接口实现
- 邮件格式以纯文本为主

#### 功能限制
- 附件支持下载查看，不支持在线编辑
- 复杂邮箱规则建议在Outlook中手动创建
- AI功能基于规则和关键词，非深度学习模型

## 故障排除

### 常见问题

#### 环境配置问题
```
问题: "python不是内部或外部命令"
解决: 
1. 确认Python 3.10+已正确安装
2. 将Python添加到系统PATH环境变量
3. 使用完整路径: C:\Python\python.exe
```

#### 路径配置问题
```
问题: "找不到指定文件"
解决:
1. 确保路径使用正确的分隔符 (\\ 或 /)
2. 验证文件路径存在且可访问
3. 避免路径中包含中文字符
```

#### 权限访问问题
```
问题: "Access denied"
解决:
1. 以管理员身份运行VS Code
2. 检查文件和目录权限设置
3. 确保Outlook客户端正在运行
```

#### 服务连接问题
```
问题: MCP服务器无响应
解决:
1. 验证Python依赖包安装完整
2. 确认Outlook客户端状态正常
3. 重启VS Code和Outlook应用
4. 检查防火墙和安全软件设置
```

## 技术支持

### 项目信息
- **仓库地址**: https://github.com/bonjourzzz/OutlookMaster-MCP
- **协议版本**: MCP 1.2.0+
- **维护状态**: 活跃开发中

### 贡献指南
欢迎提交Issue和Pull Request，请遵循项目的代码规范和提交格式。

---

*本项目遵循开源协议，仅供学习和研究使用。在生产环境中使用前，请充分测试并评估安全风险。*
